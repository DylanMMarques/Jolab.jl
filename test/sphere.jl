using Jolab, Test

m = 5. + 0.4im
x = 1.
an_ref = [0.2306-0.251im, 0.0055-0.0354im, 0-0.0008im, 0. - 0im]
bn_ref = [0.0627+0.1507im, 0.0159+0.0262im, 0.0004-0.0006im, 0. - 0im]
@test all(isapprox.(Jolab.an.([1,2,3,4],m,x), an_ref, atol = 2E-4))
@test all(isapprox.(Jolab.bn.([1,2,3,4],m,x), bn_ref, atol = 2E-4))

s1 = [0.49484026045786206 - 0.17857083733590867im,
  0.4212073736809377 - 0.2792324325096566im,
  0.30608560905302196 - 0.4414207356779078im,
  0.2706321418540056 - 0.47606782023015515im,
  0.2767070371475335 - 0.44931201656665615im]
s2 = [0.49484026045786206 - 0.17857083733590867im,
  0.36721103886458945 + 0.0068768361461347734im,
  0.07997992427886365 + 0.31514247981545174im,
  -0.1781675051399228 + 0.44380933342400625im,
  -0.2767070371475335 + 0.44931201656665615im]

an = Jolab.an.(1:7, 5 +.4im , 1.)
bn = Jolab.bn.(1:7, 5 +.4im , 1.)
θ = range(0, π, length = 5)
s = Jolab.S1S2.(cos.(θ), Ref(an), Ref(bn))
@test all(isapprox.(s1, first.(s), atol = 1E-15))
@test all(isapprox.(s2, last.(s), atol = 1E-15))
